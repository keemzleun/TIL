## 쿠키(Cookie)

- HTTP의 특성
    - Stateless(무상태성)
        - 클라이언트와 서버가 요청과 응답을 주고 받으면 연결이 끊어짐

          → 클라이언트에 대한 이전의 상태 정보 및 현재 통신 상태가 남아있지 않음

          → 클라이언트가 다시 요청하면 서버는 이전 요청을 기억하지 못함

        - 이러한 특성으로 인해 불필요한 자원 낭비를 줄일 수 있음

          → 그러나 서버는 클라이언트를 식별할 수 없게 된다는 단점이 있음

          ex) 로그인을 하더라도 다음 요청에서는 해당 클라이언트를 기억하지 못해 다시 로그인해야 함
    

- 쿠키란?
    - 서버가 사용자의 웹 브라우저에 전송하는 작은 데이터 조각
    - 브라우저는 이 데이터 조각을 저장해놓고, 동일한 서버에서 재요청시 저장된 데이터를 함께 전송함
  - 예) set-cookie: **sessionId=abcde1234**; **expires**=Sat, 26-Dec-2020 00:00:00 GMT; **path**=/; **domain**=.google.com; **Secure**
  
    - Set-Cookie: 서버에서 클라이언트로 쿠키 전달(응답)

      ![SetCookie](/img/SetCookie.png)

    - Cookie: 클라이언트가 서버에서 받은 쿠키를 저장하고 HTTP 요청시 서버로 전달

      ![Cookie](/img/Cookie.png)

    

- 쿠키의 생명주기
    - 세션 쿠키(Session Cockie): 만료 날짜를 생략하면 브라우저 종료시 까지만 유지
    - 영속 쿠키(Permanent Cookie): 만료 날짜를 입력하면 해당 날짜까지 유지
    - Set-Cookie: **expires**=Sat, 26-Dec-2020 04:39:21 GMT
        - 만료일이 되면 쿠키 삭제
    - Set-Cookie: **max-age**=3600 (3600초)
        - 0이나 음수를 지정하면 쿠키 삭제
      
        

- 쿠키의 옵션
    - 도메인
        - 쿠키는 도메인을 지정할 수 있음
            - 예) domain=example.org
        - **명시: 명시한 문서 기준 도메인 + 서브 도메인 포함**
            
        - **생략: 현재 문서 기준 도메인만 적용**

    - 경로
        - 쿠키는 경로를 지정할 수 있음
            - 예) path=/home
        - **이 경로를 포함한 하위 경로 페이지만 쿠키 접근**

    - 보안
        - Secure
            - 쿠키는 http, https를 구분하지 않고 전송
            - Secure를 적용하면 https인 경우에만 전송
        - HttpOnly
            - XSS 공격 방지
            - 자바스크립트에서 접근 불가(document.cookie)
            - HTTP 전송에만 사용
        - SameSite
            - XSRF 공격 방지
            - 요청 도메인과 쿠키에 설정된 도메인이 같은 경우만 쿠키 전송